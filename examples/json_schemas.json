{
  "description": "MoMo SMS Data Analytics Platform - JSON Schema Examples",
  "version": "1.0.0",
  "team": "Team 7 - Hannah, Saad, Cedric",
  "purpose": "Demonstrates JSON representations of database entities for API responses and data serialization",
  
  "entity_schemas": {
    "user": {
      "description": "Individual user/customer entity representation",
      "example": {
        "user_id": 1,
        "full_name": "John Mukamana",
        "phone_number": "+250788123456",
        "email": "john.mukamana@email.com",
        "created_at": "2024-09-15T10:30:00Z"
      },
      "schema": {
        "type": "object",
        "properties": {
          "user_id": {"type": "integer", "description": "Unique user identifier"},
          "full_name": {"type": "string", "maxLength": 100, "description": "Customer full name"},
          "phone_number": {"type": "string", "pattern": "^[+]?[0-9]{10,15}$", "description": "Mobile money phone number"},
          "email": {"type": "string", "format": "email", "description": "Optional email address"},
          "created_at": {"type": "string", "format": "date-time", "description": "Account creation timestamp"}
        },
        "required": ["user_id", "full_name", "phone_number"]
      }
    },

    "transaction_category": {
      "description": "Transaction category/type definition",
      "example": {
        "category_id": 1,
        "category_name": "Transfer",
        "description": "Peer-to-peer money transfer between users",
        "created_at": "2024-09-15T10:30:00Z"
      },
      "schema": {
        "type": "object",
        "properties": {
          "category_id": {"type": "integer", "description": "Unique category identifier"},
          "category_name": {
            "type": "string", 
            "enum": ["Transfer", "Payment", "Deposit", "Withdrawal", "Bill Payment", "Airtime Purchase", "Cash In", "Cash Out"],
            "description": "Category name"
          },
          "description": {"type": "string", "description": "Category description"},
          "created_at": {"type": "string", "format": "date-time", "description": "Category creation timestamp"}
        },
        "required": ["category_id", "category_name"]
      }
    },

    "transaction": {
      "description": "Individual transaction record",
      "example": {
        "transaction_id": 1,
        "sender_id": 1,
        "receiver_id": 2,
        "category_id": 1,
        "amount": 5000.00,
        "currency": "RWF",
        "timestamp": "2024-09-15T10:30:00Z",
        "status": "Completed",
        "reference_number": "TXN001234567",
        "description": "Payment for lunch"
      },
      "schema": {
        "type": "object",
        "properties": {
          "transaction_id": {"type": "integer", "description": "Unique transaction identifier"},
          "sender_id": {"type": "integer", "description": "ID of user sending money"},
          "receiver_id": {"type": "integer", "description": "ID of user receiving money"},
          "category_id": {"type": "integer", "description": "Transaction category ID"},
          "amount": {"type": "number", "minimum": 0.01, "description": "Transaction amount"},
          "currency": {"type": "string", "enum": ["RWF", "USD", "EUR", "GBP"], "description": "Currency code"},
          "timestamp": {"type": "string", "format": "date-time", "description": "Transaction timestamp"},
          "status": {"type": "string", "enum": ["Pending", "Completed", "Failed", "Cancelled"], "description": "Transaction status"},
          "reference_number": {"type": "string", "description": "Unique reference from MoMo provider"},
          "description": {"type": "string", "description": "Transaction description"}
        },
        "required": ["transaction_id", "sender_id", "receiver_id", "category_id", "amount", "currency", "timestamp", "status"]
      }
    },

    "system_log": {
      "description": "System log entry for audit and monitoring",
      "example": {
        "log_id": 1,
        "transaction_id": 1,
        "log_type": "SUCCESS",
        "message": "Transaction processed successfully",
        "created_at": "2024-09-15T10:30:05Z",
        "user_id": 1
      },
      "schema": {
        "type": "object",
        "properties": {
          "log_id": {"type": "integer", "description": "Unique log identifier"},
          "transaction_id": {"type": "integer", "nullable": true, "description": "Related transaction ID"},
          "log_type": {"type": "string", "enum": ["INFO", "ERROR", "WARNING", "SUCCESS", "DEBUG"], "description": "Log level"},
          "message": {"type": "string", "description": "Log message"},
          "created_at": {"type": "string", "format": "date-time", "description": "Log timestamp"},
          "user_id": {"type": "integer", "nullable": true, "description": "Related user ID"}
        },
        "required": ["log_id", "log_type", "message", "created_at"]
      }
    }
  },

  "complex_objects": {
    "complete_transaction_with_relations": {
      "description": "Complete transaction object with all related data (nested)",
      "example": {
        "transaction": {
          "transaction_id": 1,
          "amount": 5000.00,
          "currency": "RWF",
          "timestamp": "2024-09-15T10:30:00Z",
          "status": "Completed",
          "reference_number": "TXN001234567",
          "description": "Payment for lunch"
        },
        "sender": {
          "user_id": 1,
          "full_name": "John Mukamana",
          "phone_number": "+250788123456",
          "email": "john.mukamana@email.com"
        },
        "receiver": {
          "user_id": 2,
          "full_name": "Marie Uwimana",
          "phone_number": "+250789234567",
          "email": "marie.uwimana@email.com"
        },
        "category": {
          "category_id": 1,
          "category_name": "Transfer",
          "description": "Peer-to-peer money transfer between users"
        },
        "logs": [
          {
            "log_id": 1,
            "log_type": "SUCCESS",
            "message": "Transaction processed successfully",
            "created_at": "2024-09-15T10:30:05Z"
          },
          {
            "log_id": 2,
            "log_type": "INFO",
            "message": "SMS notification sent to receiver",
            "created_at": "2024-09-15T10:30:10Z"
          }
        ]
      }
    },

    "user_transaction_summary": {
      "description": "User profile with transaction summary statistics",
      "example": {
        "user": {
          "user_id": 1,
          "full_name": "John Mukamana",
          "phone_number": "+250788123456",
          "email": "john.mukamana@email.com",
          "created_at": "2024-09-15T10:30:00Z"
        },
        "transaction_summary": {
          "total_transactions": 15,
          "total_sent": 125000.00,
          "total_received": 85000.00,
          "net_balance": -40000.00,
          "currency": "RWF",
          "last_transaction_date": "2024-09-18T17:30:00Z",
          "transaction_categories": {
            "Transfer": {"count": 8, "total_amount": 65000.00},
            "Payment": {"count": 4, "total_amount": 45000.00},
            "Bill Payment": {"count": 2, "total_amount": 15000.00},
            "Airtime Purchase": {"count": 1, "total_amount": 5000.00}
          }
        }
      }
    },

    "analytics_dashboard_data": {
      "description": "Aggregated data for dashboard analytics",
      "example": {
        "period": {
          "start_date": "2024-09-15T00:00:00Z",
          "end_date": "2024-09-18T23:59:59Z",
          "timezone": "Africa/Kigali"
        },
        "summary_stats": {
          "total_transactions": 1250,
          "total_volume": 15750000.00,
          "average_transaction": 12600.00,
          "active_users": 45,
          "currency": "RWF"
        },
        "category_breakdown": [
          {
            "category_name": "Transfer",
            "transaction_count": 650,
            "total_amount": 8500000.00,
            "percentage": 54.0
          },
          {
            "category_name": "Payment",
            "transaction_count": 320,
            "total_amount": 4200000.00,
            "percentage": 26.7
          },
          {
            "category_name": "Bill Payment",
            "transaction_count": 180,
            "total_amount": 2250000.00,
            "percentage": 14.3
          },
          {
            "category_name": "Airtime Purchase",
            "transaction_count": 100,
            "total_amount": 800000.00,
            "percentage": 5.0
          }
        ],
        "daily_trends": [
          {
            "date": "2024-09-15",
            "transaction_count": 280,
            "total_amount": 3500000.00
          },
          {
            "date": "2024-09-16",
            "transaction_count": 320,
            "total_amount": 4200000.00
          },
          {
            "date": "2024-09-17",
            "transaction_count": 350,
            "total_amount": 4500000.00
          },
          {
            "date": "2024-09-18",
            "transaction_count": 300,
            "total_amount": 3550000.00
          }
        ]
      }
    }
  },

  "api_response_formats": {
    "single_transaction": {
      "description": "API response for GET /transactions/{id}",
      "example": {
        "success": true,
        "data": {
          "transaction": {
            "transaction_id": 1,
            "amount": 5000.00,
            "currency": "RWF",
            "timestamp": "2024-09-15T10:30:00Z",
            "status": "Completed",
            "reference_number": "TXN001234567",
            "description": "Payment for lunch"
          },
          "sender": {
            "user_id": 1,
            "full_name": "John Mukamana",
            "phone_number": "+250788123456"
          },
          "receiver": {
            "user_id": 2,
            "full_name": "Marie Uwimana",
            "phone_number": "+250789234567"
          },
          "category": {
            "category_id": 1,
            "category_name": "Transfer",
            "description": "Peer-to-peer money transfer between users"
          }
        },
        "timestamp": "2024-09-19T10:30:00Z"
      }
    },

    "transaction_list": {
      "description": "API response for GET /transactions",
      "example": {
        "success": true,
        "data": {
          "transactions": [
            {
              "transaction_id": 1,
              "amount": 5000.00,
              "currency": "RWF",
              "timestamp": "2024-09-15T10:30:00Z",
              "status": "Completed",
              "reference_number": "TXN001234567",
              "description": "Payment for lunch",
              "sender_name": "John Mukamana",
              "receiver_name": "Marie Uwimana",
              "category_name": "Transfer"
            }
          ],
          "pagination": {
            "page": 1,
            "per_page": 20,
            "total": 1250,
            "total_pages": 63
          }
        },
        "timestamp": "2024-09-19T10:30:00Z"
      }
    },

    "error_response": {
      "description": "API error response format",
      "example": {
        "success": false,
        "error": {
          "code": "TRANSACTION_NOT_FOUND",
          "message": "Transaction with ID 999 not found",
          "details": "The requested transaction does not exist in the database"
        },
        "timestamp": "2024-09-19T10:30:00Z"
      }
    }
  },

  "sql_to_json_mapping": {
    "description": "Mapping between SQL database tables and JSON representations",
    "mappings": {
      "Users table": {
        "sql_columns": ["user_id", "full_name", "phone_number", "email", "created_at"],
        "json_properties": ["user_id", "full_name", "phone_number", "email", "created_at"],
        "transformations": {
          "created_at": "Convert MySQL DATETIME to ISO 8601 format",
          "phone_number": "Maintain as string with validation",
          "email": "Keep as string, can be null"
        }
      },
      "Transactions table": {
        "sql_columns": ["transaction_id", "sender_id", "receiver_id", "category_id", "amount", "currency", "timestamp", "status", "reference_number", "description"],
        "json_properties": ["transaction_id", "amount", "currency", "timestamp", "status", "reference_number", "description", "sender", "receiver", "category"],
        "transformations": {
          "timestamp": "Convert MySQL DATETIME to ISO 8601 format",
          "amount": "Keep as decimal number",
          "sender_id": "Join with Users table to get sender object",
          "receiver_id": "Join with Users table to get receiver object",
          "category_id": "Join with Transaction_Categories table to get category object"
        }
      },
      "System_Logs table": {
        "sql_columns": ["log_id", "transaction_id", "log_type", "message", "created_at", "user_id"],
        "json_properties": ["log_id", "transaction_id", "log_type", "message", "created_at", "user_id"],
        "transformations": {
          "created_at": "Convert MySQL DATETIME to ISO 8601 format",
          "transaction_id": "Can be null for system events",
          "user_id": "Can be null for system events"
        }
      }
    }
  }
}
